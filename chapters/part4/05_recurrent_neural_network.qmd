# ４-５. Recurrent Neural Network (Recurrent Neural Network)

**問１**

次のプログラムはLSTMの各時刻tでの中間層計算の処理を記述したものである。
LSTMは従来のRNNに比べてゲート制御用の重みの重みやバイアスの種類が多く、似たような計算を何度も行う必要がある。計算を効率よく行うために中間層伝播、ゲート3種類を計算するために必要な「入力」と「前時刻の中間層出力」の重み付き線形和はまとめて計算する。

```python
n_input = 100  
n_hidden = 256

w = （あ）  
b = np.zeros(n_hidden * 4)

def lstm(x, h, c):  
    """
    x: shape (batch_size, n_input)
    h: shape (batch_size, n_hidden)
    c: shape (batch_size, n_hidden)
    """
    # ゲートおよび入力の Wx + Uh + b の項をまとめて計算  
    inputs = np.concatenate((x, h), axis=1)  
    inputs = np.matmul(inputs, w) + b  
    z, i, f, o = np.hsplit(inputs, 4)  
    ...
```
(あ)に当てはまる式として正しいものを、以下の選択肢から選べ。

A. `np.random.randn(n_input * n_hidden, n_hidden * 3)`  
B. `np.random.randn(n_input * n_hidden, n_hidden * 4)`  
C. `np.random.randn(n_input + n_hidden, n_hidden * 3)`  
D. `np.random.randn(n_input + n_hidden, n_hidden * 4)`  

**問２**

LSTMとGRU(Gated Recurrent Unit)について、それぞれに含まれるゲートの名称を全て答えよ。
